# **Chap4 FNN**

## **1.ç¥ç»å…ƒ**

#### **0.ç¥ç»å…ƒåŸºæœ¬æœ¯è¯­**

###### **1.äººå·¥ç¥ç»å…ƒ(Artificial Neuron)**

**æ¨¡æ‹Ÿç”Ÿç‰©ç¥ç»å…ƒçš„ç»“æ„å’Œç‰¹æ€§,ç»™ä¸€ç»„è¾“å…¥äº§ç”Ÿè¾“å‡º**

###### **2.MPç¥ç»å…ƒ**

**1943å¹´æå‡ºçš„ç¥ç»å…ƒæ¨¡å‹,å…¶ä¸­çš„æ¿€æ´»å‡½æ•°ä¸º0-1çš„é˜¶è·ƒå‡½æ•°**

>   ==ç„¶è€Œç°åœ¨çš„ç¥ç»å…ƒä¸­çš„æ¿€æ´»å‡½æ•°è¦æ±‚çš„æ˜¯è¿ç»­å¯å¯¼çš„å‡½æ•°==

###### **3.ç¥ç»å…ƒçš„ç»„æˆ**

**1.å‡€è¾“å…¥ $z$**

>   **å‡è®¾ç¥ç»å…ƒæ¥æ”¶Dä¸ªè¾“å…¥$x_1,x_2,\cdots,x_D$,ä»¤å‘é‡x=[$x_1,x_2,\cdots,x_D $],ä½¿ç”¨$z\in \mathbb{R} $è¡¨ç¤ºå‡€è¾“å…¥**
>   $$
>   z = \sum^{D}_{d=1}\omega_d x_d + b = \omega^T x +b = \omega^Tx+\omega_0
>   $$
>   **å…¶ä¸­$\omega = [\omega_1,\omega_2,\cdots,\omega_D]\in \mathbb{R}^D $æ˜¯Dç»´çš„æƒé‡å‘é‡,$b\in \mathbb{R} $æ˜¯åç½®é¡¹**

**2.æ¿€æ´»å‡½æ•°(éçº¿æ€§å› ç´ )** $f(\cdot) $

>   **ä¸ºå‡€è¾“å…¥æ·»åŠ éçº¿æ€§å› ç´ çš„å·¥å…·,è¾“å…¥==å‡€è¾“å…¥==,è¾“å‡º==ç¥ç»å…ƒæ´»æ€§å€¼$\alpha $==**
>
>   **<font color=deeppink>æœŸæœ«è€ƒè¯•å¿…è€ƒ</font>**

**3.å¯è§†åŒ–å†…å®¹**

>   <img src="./assets/image-20250407082218691.png" alt="image-20250407082218691" style="zoom:50%;" />

**4.å¤šåˆ†ç±»é—®é¢˜çš„å¯è§†åŒ–**

>   æ¯”å¦‚0~9çš„è¯†åˆ«
>
>   é¦–å…ˆæ˜¯10ä¸ªèŠ‚ç‚¹çš„input layer,ç„¶åå…¨è¿æ¥10ä¸ªèŠ‚ç‚¹çš„hidden layer,ç„¶åhiddenæ¯ä¸ªèŠ‚ç‚¹ç»è¿‡activation functionä»¥åå¾—åˆ°$\sigma(x_i) $çš„è¾“å‡º

###### **4.æ¿€æ´»å‡½æ•°çš„æ€§è´¨**

**1.è¿ç»­å¹¶å¯å¯¼çš„éçº¿æ€§å‡½æ•°**

>   ==å¯å¯¼çš„æ¿€æ´»å‡½æ•°**å¯ä»¥ç›´æ¥åˆ©ç”¨æ•°å€¼ä¼˜åŒ–çš„æ–¹æ³•**å­¦ä¹ ç½‘ç»œå‚æ•°==
>
>   **<font color=red>é“¾æ¥ç¥ç»èŠ‚ç‚¹çš„å†…å®¹æ˜¯å‚æ•°$\omegaÂ $,å¦‚æœè¦å­¦ä¹ çš„è¯æ¶‰åŠæ¢¯åº¦ä¸‹é™</font>**

**2.å°½å¯èƒ½çš„ç®€å•,æœ‰åˆ©äºæé«˜ç½‘ç»œçš„è®¡ç®—æ•ˆç‡**

**3.å¯¼å‡½æ•°è¦åœ¨ä¸€ä¸ªåˆé€‚çš„åŒºåŸŸä¸­,å¦åˆ™ä¼šå½±å“è®­ç»ƒçš„ç¨³å®šæ€§å’Œæ•ˆç‡**

>   **æ¯”å¦‚ä½¿ç”¨0-1å€¼åŸŸçš„å‡½æ•°,å…¨è¿æ¥ä»¥åå€¼åŸŸä¾æ—§æ˜¯0-1**
>
>   **<font color=red>å¦‚æœå€¼åŸŸè¿‡ç•Œ,åå¯¼æ•°ä¸º0,æ— æ³•ä¼˜åŒ–->æ¢¯åº¦æ¶ˆå¤±/ç¥ç»å…ƒæ­»äº¡</font>**

**<font color=red>4.ä¸éœ€è¦å•è°ƒé€’å¢,æ¯”å¦‚swishå‡½æ•°$f(x) = x * sigmoid(Î²x)$</font>**

>   ![activation-functions](./assets/activation-functions.gif)



#### **1.Sigmoidå‡½æ•°**

###### **1.æ€§è´¨**

**`sigmoid`å‡½æ•°æ˜¯æŒ‡ä¸€ç±»Så‹æ›²çº¿,ä¸ºä¸¤ç«¯é¥±å’Œå‡½æ•°**

**<font color=deeppink>å¸¸è§çš„`sigmoid`å‡½æ•°åŒ…æ‹¬Logisticå‡½æ•°å’ŒTanhå‡½æ•°</font> **

<img src="./assets/image-20250407083049875.png" alt="image-20250407083049875" style="zoom:50%;" />

###### **2.Logisticå‡½æ•°**

$$
\sigma(x) = \frac{1}{1+e^{-x}}
$$

**ä¸»è¦ä½œç”¨:å°†å®æ•°åŸŸçš„è¾“å…¥æŒ¤å‹åˆ°(0,1)**

**ä¸»è¦æ€§è´¨:**

>   **<font color=deeppink>è¾“å‡ºå¯ä»¥ç›´æ¥çœ‹ä½œæ¦‚ç‡åˆ†å¸ƒ</font>**
>
>   **<font color=deeppink>Logisticå‡½æ•°å¯ä»¥çœ‹ä½œä¸€ä¸ªè½¯æ€§é—¨,ç”¨äºæ§åˆ¶å…¶å®ƒç¥ç»å…ƒè¾“å‡ºä¿¡æ¯</font>**

###### **3.tanhå‡½æ•°**

>   $$
>   tanh(x) = \frac{e^{x}-e^{-x}}{e^{x}+e^{-x}}
>   $$
>
>   **(==å¯ä»¥è§†ä½œæ”¾å¤§å¹¶ä¸”å¹³ç§»åçš„Logisticå‡½æ•°==):$tanh(x) = 2\sigma(2x)-1 $**

###### **4.Hard-Logisticå’ŒHard-Tanhå‡½æ•°**

**<font color=deeppink>Hardçš„åŸç†å°±æ˜¯å¯¹å‡½æ•°åœ¨0é™„è¿‘æ³°å‹’å±•å¼€åçš„åˆ†æ®µå‡½æ•°è¿‘ä¼¼</font>**

**1.Hard-Logistic**

>   **Logisticå‡½æ•°çš„å¯¼æ•°(å¤‡ç”¨)**
>   $$
>   \sigma'(x) = \sigma(x)(1-\sigma(x))
>   $$
>   **å¯¹è¯¥å‡½æ•°æ³°å‹’å±•å¼€**
>   $$
>   g_l(x)\approx \sigma(0)+x\times \sigma'(0) = 0.25x+0.5
>   $$
>   **Hard-Logisticå‡½æ•°**
>   $$
>   hard-Logistic =
>   \begin{cases}
>   1&g_l(x)\geq 1\\
>   \\
>   g_l &0<g_l(x)<l \\
>   \\
>   0&g_l(x)\leq0
>   \end{cases}
>   \quad = max(min(0.25x+0.5,1),0)
>   $$
>   <img src="./assets/image-20250407084539397.png" alt="image-20250407084539397" style="zoom:80%;" />

**2.Hard-Tanh**

>   **tanhå‡½æ•°çš„å¯¼æ•°(å¤‡ç”¨)**
>   $$
>   tanh'(x) = 1-(tanh(x))^2
>   $$
>   **å¯¹è¯¥Tanhå‡½æ•°åœ¨0é™„è¿‘æ³°å‹’å±•å¼€**
>   $$
>   g_t(x)\approx tanh(0)+x\times tanh'(0) = x
>   $$
>   **Hard-tanhå‡½æ•°**
>   $$
>   hard-Tanh = max(min(g_t(x),1),-1)
>   $$
>   <img src="./assets/image-20250407084552040.png" alt="image-20250407084552040" style="zoom:80%;" />

#### **2.ReLUå‡½æ•°**

###### **1.ReLUåŸºæœ¬å®šä¹‰**

**ReLu(Rectified Linear Unit,ä¿®æ­£çº¿æ€§å•å…ƒ),ä¹Ÿç§°Rectifierå‡½æ•°,ä¹Ÿç§°æ–œå¡å‡½æ•°**

==éœ€è¦æ³¨æ„,åªçœ‹å³åŠè¾¹å°±æ˜¯çº¿æ€§çš„,ä½†æ˜¯æ•´ä½“æ˜¯éçº¿æ€§çš„==
$$
ReLU(x) = 
\begin{cases}
x & x\geq 0\\
0& x<0
\end{cases} = max(0,x)
$$

###### **2.ReLUçš„ä¼˜ç‚¹å’Œç¼ºç‚¹**

**ä¼˜ç‚¹**

>   **1.è®¡ç®—ç®€å•,åªéœ€è¦åŠ æ³•ä¹˜æ³•å’Œæ¯”è¾ƒ**
>
>   **2.ç”Ÿç‰©å­¦åˆç†æ€§:==å•ä¾§æŠ‘åˆ¶,å®½å…´å¥‹è¾¹ç•Œ==**
>
>   **3.ç¨€ç–æ€§:å’Œç”Ÿç‰©å­¦å…´å¥‹ç¥ç»æ¯”ä¾‹ç±»ä¼¼1%~4%**

**ç¼ºç‚¹**

>   **1.ä¼˜åŒ–å›°éš¾:éé›¶ä¸­å¿ƒåŒ–çš„,ä¼šç»™åä¸€å±‚å¼•å…¥==åç½®åç§»==,å½±å“æ¢¯åº¦ä¸‹é™æ•ˆç‡**
>
>   **2.<font color=deeppink>ReLUæ­»äº¡é—®é¢˜:å‚æ•°åœ¨ä¸€æ¬¡ä¸æ°å½“çš„æ›´æ–°å,æŸä¸ªç¥ç»å…ƒä¼šåœ¨ä¹‹åæ‰€æœ‰çš„æ•°æ®ä¸Šæ— æ³•æ¿€æ´»</font>**
>
>   (ç»¼ä¸Š,ä¼šå¼•å…¥ä»¥ä¸‹çš„ReLuå˜ç§)

###### **3.Leaky ReLU (æ³„éœ²æå°ReLU)**

**ä¸»è¦æ€æƒ³ï¼šåœ¨x<0æ—¶,ä¿æŒä¸€ä¸ªå¾ˆå°çš„æ¢¯åº¦$\gamma $,é¿å…æ°¸è¿œå¤±æ´»**
$$
LeakyReLu(x) = 
\begin{cases}
x& if \ x>0\\
\\
\gamma x& if\ x\leq 0
\end{cases}
\quad
=max(0,x)+\gamma min(0,x)
\\
\\
if \ \gamma \rightarrow\epsilon(æå°å€¼),LeakyReLU = max(x,\gamma x)
$$

###### **4.PReLUï¼ˆParametric ReLU,å‚æ•°ReLUï¼‰**

**ä¸€ç§éé¥±å’Œçš„å‡½æ•°,å¼•å…¥å‚æ•°$\gamma_1$,ä½¿å¾—æ¯ä¸ªç¥ç»å…ƒéƒ½æœ‰å„è‡ªçš„æƒé‡**
$$
PReLU_i(x) = 
\begin{cases}
x & if \ x>0\\
\\
\gamma_ix&if\ x\leq0
\end{cases} = max(0,x)+\gamma_imin(0,x)
$$
**å¦‚æœ$\gamma_i=0$,é€€åŒ–æˆReLU;å¦‚æœ$\gamma_i$æ˜¯å¾ˆå°çš„å¸¸æ•°,åˆ™æˆä¸ºLeaky ReLU**

###### **5.ELUï¼ˆExponential ReLU,æŒ‡æ•°ReLUï¼‰**

$$
ELU(x) = 
\begin{cases}
x & if \ x>0\\
\\
\gamma(e^x - 1)& if \ x\leq 0
\end{cases}
 = max(0,x)+min(0,\gamma(e^x-1))
$$

###### **6.Softplus(å¹³æ»‘ReLU)**

$$
softplus(x) = log(1+e^x)
$$

![Softpluså‡½æ•°çš„å›¾åƒ](./assets/805c265cc4a5cb9a2ce4b6c89a4b8450.png)

###### **<font color=red>7.DyTï¼ˆåŠ¨æ€åŒæ›²æ­£åˆ‡ï¼‰(CVPR 2025)</font>**

![img](./assets/640.png)

#### **3.Swishå‡½æ•°**

$$
swish(x) = x\sigma(\beta x)\\
\\
\sigma(x)æ˜¯Logisticå‡½æ•°,\betaæ˜¯å›ºå®šè¶…å‚æ•°
$$

![image-20250420114927304](./assets/image-20250420114927304.png)

>   $\beta=0,swish\rightarrow\frac{x}{2} $
>
>   $\beta =1,swish\rightarrowè¿‘ä¼¼é¥±å’Œä½†æ˜¯å…·æœ‰éå•è°ƒæ€§ $
>
>   $\beta\rightarrow +\infty,swishè¶‹è¿‘äº0-1å‡½æ•°$
>
>   (swishå¯ä»¥çœ‹ä½œçº¿æ€§å‡½æ•°å’ŒReLUä¹‹é—´çš„éçº¿æ€§æ’å€¼å‡½æ•°)

#### **4.GELUå‡½æ•°**

GELUï¼ˆGaussian Error Linear Unitï¼Œé«˜æ–¯è¯¯å·®çº¿æ€§å•å…ƒï¼‰

ä¸€ç§é€šè¿‡é—¨æ§æœºåˆ¶æ¥è°ƒæ•´å…¶è¾“å‡ºå€¼çš„æ¿€æ´»å‡½æ•°
$$
GELU(x) = xP(X\leq x)\\
(P(X\leq x)æ˜¯é«˜æ–¯åˆ†å¸ƒ\mathbb{N}(\mu,\sigma^2)çš„ç´¯è®¡åˆ†å¸ƒå‡½æ•°)
$$
å¦‚æœ$\mu=0.\sigma=1 $,é«˜æ–¯åˆ†å¸ƒçš„ç´¯è®¡åˆ†å¸ƒå‡½æ•°å¯ä»¥ä½¿ç”¨Tanhå’ŒLogisticæ¥è¿‘ä¼¼
$$
GELU(x)\approx 0.5x(1+tanh(\sqrt{\frac{2}{\pi}}(x+0.044715x^3)))\approx x\sigma(1.702 x)
$$

#### **5.Maxoutå•å…ƒ**

**ä¹Ÿæ˜¯ä¸€ç§åˆ†æ®µçº¿æ€§å‡½æ•°,æ™®é€šçš„æ¿€æ´»å‡½æ•°çš„è¾“å…¥æ˜¯ä¸€ä¸ªæ ‡é‡,Maxoutæ˜¯ä¸€ä¸ªå‘é‡**
$$
z_k= \omega^T_k x+b_k (ä¸€å…±æœ‰kä¸ª)
$$
(æ¯ä¸ªMaxoutå•å…ƒæœ‰**Kä¸ª**æƒé‡å‘é‡$\omega_k\in\mathbb{R}^D $å’Œåç½®$b_k $)

**Maxoutå•å…ƒçš„éçº¿æ€§å‡½æ•°å®šä¹‰ä¸º**
$$
maxout(x) = max(z_k)
$$
**Maxout å•å…ƒä¸å•æ˜¯å‡€è¾“å…¥åˆ°è¾“å‡ºä¹‹é—´çš„éçº¿æ€§æ˜ å°„**

**è€Œæ˜¯æ•´ä½“å­¦ä¹ è¾“å…¥åˆ°è¾“å‡ºä¹‹é—´çš„éçº¿æ€§æ˜ å°„å…³ç³»ï¼**

Maxout æ¿€æ´»å‡½æ•°å¯ä»¥çœ‹ä½œä»»æ„å‡¸å‡½æ•°çš„åˆ†æ®µçº¿æ€§è¿‘ä¼¼ï¼Œå¹¶ä¸”åœ¨æœ‰é™çš„ç‚¹ä¸Šæ˜¯ä¸å¯å¾®çš„

## **2.ç½‘ç»œç»“æ„**

#### **1.FNNå‰é¦ˆç¥ç»ç½‘ç»œ**

ç¥ç»å…ƒæŒ‰ç…§å±‚è¿›è¡Œåˆ†ç»„,æ¯å±‚çš„ä¿¡æ¯éƒ½æ˜¯æœä¸€ä¸ªæ–¹å‘ä¼ æ’­,**æ²¡æœ‰åå‘ä¼ æ’­**

å¯ä»¥ç”¨ä¸€ä¸ªæœ‰å‘æ— ç¯è·¯å›¾è¿›è¡Œè¡¨ç¤º

**åŒ…æ‹¬:å…¨è¿æ¥å‰é¦ˆç½‘ç»œ(FNN)å’Œå·ç§¯ç¥ç»ç½‘ç»œ(CNN)**

#### **2.MANNè®°å¿†å¢å¼ºç¥ç»ç½‘ç»œ**

###### **1.è®°å¿†ç½‘ç»œåŸºæœ¬æ¦‚å¿µ**

è®°å¿†ç½‘ç»œ(åé¦ˆç½‘ç»œ)ï¼Œç¥ç»å…ƒä¸ä½†å¯ä»¥æ¥æ”¶å…¶ä»–ç¥ç»å…ƒçš„ä¿¡æ¯ï¼Œä¹Ÿå¯æ¥æ”¶è‡ªå·±çš„å†å²ä¿¡æ¯

è®°å¿†ç¥ç»ç½‘ç»œä¸­çš„ä¿¡æ¯ä¼ æ’­å¯ä»¥æ˜¯å•å‘æˆ–åŒå‘ä¼ é€’ï¼Œå¯ç”¨ä¸€ä¸ªæœ‰å‘å¾ªç¯å›¾æˆ–æ— å‘å›¾æ¥è¡¨ç¤º

###### **2.è®°å¿†ç½‘ç»œåˆ†ç±»**

**åŒ…æ‹¬:å¾ªç¯ç¥ç»ç½‘ç»œã€Hopfield ç½‘ç»œã€ç»å°”å…¹æ›¼æœºã€å—é™ç»å°”å…¹æ›¼æœº**

**è®°å¿†ç½‘ç»œå¯ä»¥çœ‹ä½œä¸€ä¸ªç¨‹åºï¼Œå…·æœ‰æ›´å¼ºçš„è®¡ç®—å’Œè®°å¿†èƒ½åŠ›**

###### **3.MANN**

**==ä¸ºäº†å¢å¼ºè®°å¿†ç½‘ç»œçš„è®°å¿†å®¹é‡ï¼Œå¯ä»¥å¼•å…¥å¤–éƒ¨è®°å¿†å•å…ƒå’Œè¯»å†™æœºåˆ¶==**

>ç§°ä¸ºè®°å¿†å¢å¼ºç¥ç»ç½‘ç»œï¼ˆMemory Augmented Neural Networkï¼ŒMANNï¼‰
>
>**åŒ…æ‹¬:ç¥ç»å›¾çµæœºå’Œè®°å¿†ç½‘ç»œ**

#### **3.å›¾ç½‘ç»œ**

###### **1.å›¾ç½‘ç»œçš„å‰æ**

å‰é¦ˆç½‘ç»œå’Œè®°å¿†ç½‘ç»œçš„è¾“å…¥éƒ½å¯ä»¥è¡¨ç¤ºä¸ºå‘é‡æˆ–å‘é‡åºåˆ—

**ç„¶è€Œå®é™…åº”ç”¨ä¸­å¾ˆå¤šæ•°æ®æ˜¯å›¾ç»“æ„çš„æ•°æ®ï¼Œæ¯”å¦‚çŸ¥è¯†å›¾è°±ã€ç¤¾äº¤ç½‘ç»œã€åˆ†å­ç½‘ç»œç­‰**

###### **2.å›¾ç½‘ç»œçš„å®šä¹‰**

(å›¾ç½‘ç»œæ˜¯å®šä¹‰åœ¨**å›¾ç»“æ„æ•°æ®**ä¸Šçš„ç¥ç»ç½‘,è€Œä¸æ˜¯å› ä¸ºæ˜¯å›¾)

å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹éƒ½ç”±ä¸€ä¸ªæˆ–ä¸€ç»„ç¥ç»å…ƒæ„æˆï¼èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥å¯ä»¥æœ‰å‘/å¯ä»¥æ— å‘

æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æ”¶åˆ°æ¥è‡ªç›¸é‚»èŠ‚ç‚¹æˆ–è‡ªèº«çš„ä¿¡æ¯ï¼

###### **3.å›¾ç½‘ç»œçš„åˆ†ç±»**

å›¾å·ç§¯ç½‘ç»œï¼ˆGraph Convolutional Networkï¼ŒGCNï¼‰

å›¾æ³¨æ„åŠ›ç½‘ç»œï¼ˆGraph Attention Networkï¼ŒGATï¼‰

æ¶ˆæ¯ä¼ é€’ç¥ç»ç½‘ç»œï¼ˆMessage Passing Neural Networkï¼ŒMPNNï¼‰

## **3.FNN(å‰é¦ˆç¥ç»ç½‘ç»œ)**

###### **1.FNNå®šä¹‰**

ç¥ç»å…ƒçš„ä¸€ç§æ‹“æ‰‘ç»“æ„,å‰é¦ˆç¥ç»ç½‘ç»œ(FNN)ä¹Ÿç§°ä½œå¤šå±‚æ„ŸçŸ¥æœº(MLP)

>ä½†å¤šå±‚æ„ŸçŸ¥å™¨çš„å«æ³•å¹¶ä¸æ˜¯ååˆ†åˆç†
>
>å› ä¸ºå‰é¦ˆç¥ç»ç½‘ç»œå…¶å®æ˜¯ç”±å¤šå±‚çš„Logistic å›å½’æ¨¡å‹ï¼ˆè¿ç»­çš„éçº¿æ€§å‡½æ•°ï¼‰ç»„æˆ
>
>è€Œä¸æ˜¯ç”±å¤šå±‚çš„æ„ŸçŸ¥å™¨ï¼ˆä¸è¿ç»­çš„éçº¿æ€§å‡½æ•°ï¼‰ç»„æˆ

**<font color=red>sigmoidå’Œsoftmax in FNN</font>**

(èƒŒæ™¯æ˜¯åˆ¤åˆ«æ‰‹å†™å­—ç¬¦0~9)

**Sigmoid nä¸ªsigmoidè¾“å…¥å•ä¸ªå€¼,è¾“å‡ºæ˜¯ç‹¬ç«‹çš„==å¯èƒ½æ€§==ï¼š** 

```
input -> hidden -> output -> sigmoid activation -> argmax 
256*256   256      10 Neu      10 Neu			 1 result
  		  128
  		  ...
```

**argmax 1ä¸ªå‘é‡nä¸ªå€¼,è¾“å…¥ä¸€ä¸ªargmaxå‡½æ•°,è¾“å‡ºæ˜¯äº’æ–¥ç±»åˆ«ä¸Šçš„==æ¦‚ç‡åˆ†å¸ƒ==**

å¯ä»¥æ›´å¥½è·Ÿäº¤å‰ç†µæŸå¤±å‡½æ•°åŒæ­¥

```
input -> hidden -> output -> softmax activation -> distribution
256*256   256      10 Neu      1vec(10 Neu)		   1 result
  		  128
  		  ...
```

###### **2.FNNç»“æ„**

**1.Layer**

==**ç¬¬$0 $å±‚ç§°ä¸ºè¾“å…¥å±‚ï¼Œæœ€åä¸€å±‚ç§°ä¸ºè¾“å‡ºå±‚ï¼Œå…¶ä»–ä¸­é—´å±‚ç§°ä¸ºéšè—å±‚**==

**2.Neuron**

>   **$z^l_i $ :è¡¨ç¤ºåœ¨ç¬¬Lä¸ªLayerçš„ç¬¬iä¸ªç¥ç»å…ƒçš„å‡€è¾“å…¥**
>
>   **$a^{l} $:è¡¨ç¤ºæ¿€æ´»å€¼,ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸Šä¸€å±‚çš„è¾“å‡ºå€¼,<font color=red>ä½†æ³¨æ„$ a^{0}$å…¶å®è¡¨ç¤ºä¸ºè¾“å…¥å±‚</font>**
>
>   **$W^{L}_{ij} $è¡¨ç¤ºijä¸¤ä¸ªç¥ç»å…ƒçš„è¿æ¥æƒé‡(å…·ä½“è€Œè¨€æ˜¯Lå±‚çš„ç¬¬iä¸ªç¥ç»å…ƒåˆ°ç¬¬jä¸ªç¥ç»å…ƒ)****
>
>   **$b^{l} $:è¡¨ç¤ºæƒé‡L-1å±‚åˆ°Lå±‚çš„åç½®é¡¹**
>   $$
>   \therefore z^{l} = W^{(l)}a^{(l-1)}+b^{(l)}\\
>   a^{(l)}_i  = \sigma{(z^{l})}
>   $$

**3.å‰å‘ä¼ æ’­**

>   ç¬¬0å±‚çš„æ¿€æ´»å€¼$a^{(0)}$
>
>   ç¬¬1å±‚çš„æ¿€æ´»å€¼$ a^{(1)} = \sigma(z^{1}) = \sigma(W^{(1)T} a^{(0)}+(b))$(æˆ–è€…ç›´æ¥æŠŠbæ”¾åˆ°aå‘é‡çš„å¢å¹¿é‡Œé¢)
>
>   ç¬¬2å±‚çš„æ¿€æ´»å€¼$ a^{(2)} = \sigma(z^{2}) = \sigma(W^{(2)T} a^{(1)}+(b))$(æˆ–è€…ç›´æ¥æŠŠbæ”¾åˆ°aå‘é‡çš„å¢å¹¿é‡Œé¢)
>
>   **<font color=red>(å…¶ä¸­å…·ä½“çš„è®¡ç®—:å‡è®¾ä¸€å±‚åªæœ‰ä¸¤ä¸ªNer)</font>**
>   $$
>   a^1_1 = \sigma(w^1_ {11}x_1+ \omega^1_{21}x_2 )Â  =\sigma(w^1_{11} a^0_1+ \omega^1_{21}a^0_2 )
>   $$
>   **å¯ä»¥è¡¨ç¤ºä¸º$X = \begin{pmatrix}x_1\\x_2\end{pmatrix},W = \begin{pmatrix}w^1_{11}&w^{1}_{12}\\ w^2_{21}&w^2_{22}\end{pmatrix},ç›®æ ‡\sigma[W = \begin{pmatrix}w^1_{11}&w^{1}_{12}\\ w^2_{21}&w^2_{22}\end{pmatrix}] $ (å¦‚æœæœ‰1wå±‚,åˆ™Wæœ‰1wåˆ—)**
>
>   $a^1\rightarrow \sigma(W_1^Tx)\rightarrow a^2\rightarrow  \sigma(W^T_2 x)$

**4.æ„å»ºæƒé‡çŸ©é˜µW**

>   (ä¸»è¦å’Œä¸Šä¸€å±‚çš„å‚æ•°é‡å’Œä¸‹ä¸€å±‚çš„å‚æ•°é‡ç›¸å…³)
>
>   Eg:è¾“å…¥çš„å›¾ç‰‡çš„ç‰¹å¾è¾“å…¥ç»´åº¦æ˜¯512,æœ€ååªæœ‰10ä¸ªç‰¹å¾
>
>   è¾“å…¥ç»´åº¦ç”¨pè¡¨ç¤º,è¾“å‡ºç»´åº¦ç”¨nè¡¨ç¤º,æƒé‡çŸ©é˜µçš„å¤§å°å°±æ˜¯[n,p]
>
>   ```
>   p:    512      -> 256      ->128     ->64     ->32
>   W:    [256,512]-> [128,256]->[64,128]->[32,64]->[10,32]
>   n:    256      -> 128      ->64      ->32     ->10
>   ```
>
>   **<font color=red>ç»´åº¦ç¼©å‡çš„æƒ…å†µ:é¢„æµ‹å’Œåˆ†ç±»çš„å‰å‘ä¼ æ’­/é«˜ç»´åˆ°ä½ç»´çš„ç‰¹å¾æå–/å‡å°‘å‚æ•°é¿å…è¿‡æ‹Ÿåˆ</font>**
>
>   **ç»´åº¦ä¸å˜çš„æƒ…å†µ:RNNçš„æ—¶é—´æ­¥ä¹‹é—´ä¿æŒå›ºå®šå¤§å°**
>
>   **ç»´åº¦æ”¾ç¼©:Transformerå…ˆå°†ç»´åº¦å¢åŠ ,ç„¶åæ¢å¤/è‡ªç¼–ç å™¨å…ˆå°†ç»´åº¦é™ä½,ç„¶åæ¢å¤**

**5.å­¦ä¹ ç®—æ³•**

>**å›å½’é—®é¢˜:å‡æ–¹è¯¯å·®å‡½æ•°(MSE)**
>
>**åˆ†ç±»é—®é¢˜:äº¤å‰ç†µæŸå¤±å‡½æ•°**
>
>>   æ¯”å¦‚è¾“å…¥æ ‡ç­¾10ä¸ª(ç‹¬çƒ­æ ‡ç­¾[0,0,0,0,1,0,0,0,0,0])
>>
>>   è¾“å‡ºå±‚ä¹Ÿæ˜¯10ä¸ª[0,0.3...0,1..]
>>
>>   ç„¶åç”¨æŸå¤±å‡½æ•°:ä¸¤è€…ç›¸å‡çš„å‡æ–¹è¯¯å·®

**éœ€è¦æ³¨æ„çš„æ˜¯$ x = a^{0}\rightarrow z^{(1)}\rightarrow a^{(1)}\rightarrow z^{(2)}\rightarrow a^{(2)} $**

**å¦‚æœæŠŠå›¾ç‰‡çš„åƒç´ æ‹‰æˆä¸€ä¸ªåˆ—å‘é‡ï¼Œä¼šå¯¹å…‰ç…§æ›´æ•æ„Ÿ->ä½¿ç”¨ç‰¹å¾å‘é‡ï¼ˆç‰¹å¾å·¥ç¨‹ï¼‰**

#### **1.é€šç”¨è¿‘ä¼¼å®šç†**

**ç»“è®º:ï¼Œå¯¹äºå…·æœ‰çº¿æ€§è¾“å‡ºå±‚å’Œä¸€ä¸ªâ€œæŒ¤å‹â€æ¿€æ´»å‡½æ•°çš„éšè—å±‚ç»„æˆçš„å‰é¦ˆç¥ç»ç½‘ç»œï¼Œ**

**éšè—å±‚ç¥ç»å…ƒçš„æ•°é‡è¶³å¤Ÿï¼Œå®ƒå¯ä»¥è¿‘ä¼¼ä»»ä½•ä¸€ä¸ªå®šä¹‰åœ¨å®æ•°ç©ºé—´ä¸­çš„æœ‰ç•Œé—­é›†å‡½æ•°**

<img src="./assets/image-20250420164041094.png" alt="image-20250420164041094" style="zoom:80%;" />

#### **2.åº”ç”¨äºæœºå™¨å­¦ä¹ **

**1.ç‰¹å¾æ˜ å°„**

FNNå¯ä»¥å°†åŸå§‹è¾“å…¥$ x $é€šè¿‡éçº¿æ€§å˜æ¢$ Ï•(x) $æ˜ å°„åˆ°æ›´æœ‰ç”¨çš„ç‰¹å¾ç©ºé—´ï¼Œä»è€Œæé«˜åˆ†ç±»å™¨æ•ˆæœ

**2.è¾“å‡ºé¢„æµ‹**

ifä½¿ç”¨çš„åˆ†ç±»å™¨æ˜¯Logistic/softmaxåˆ†ç±»å™¨,é‚£ä¹ˆåˆ†ç±»å™¨å¯ä»¥çœ‹ä½œç¥ç»ç½‘ç»œæœ€åä¸€å±‚

ç¥ç»ç½‘ç»œç›´æ¥è¾“å‡ºä¸åŒç±»åˆ«çš„æ¡ä»¶æ¦‚ç‡ğ‘(ğ‘¦|ğ’™),å³
$$
sigmoidæƒ…å†µ:p(y=1|x) = a^{(L)}\\

softmaxæƒ…å†µ:\hat{y} = softmax(z^{(L)})
$$

#### **3.FNNå‚æ•°å­¦ä¹ **

**ç±»ä¼¼æœºå™¨å­¦ä¹ :ç»“æ„åŒ–é£é™©å‡½æ•°(æ­£åˆ™åŒ–)**

>   **æ­£åˆ™åŒ–é¡¹:==ä»pèŒƒæ•°æ¢æˆäº†FrobeniusèŒƒæ•°==**

**<font color=red>å‚æ•°çŸ©é˜µWåˆå§‹åŒ–:</font>**

>åœ¨å…¨è¿æ¥ç¥ç»ç½‘ç»œ (FNN) ä¸­ï¼Œæƒé‡çŸ©é˜µ W çš„åˆå§‹åŒ–æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ­¥éª¤ã€‚
>
>**å…³äºæƒé‡çŸ©é˜µèƒ½å¦éƒ½ç­‰äº 0 çš„é—®é¢˜ï¼š**
>
>**==ç­”æ¡ˆæ˜¯ï¼šä¸èƒ½ï¼Œç»å¯¹ä¸èƒ½å°†æ‰€æœ‰æƒé‡åˆå§‹åŒ–ä¸º 0ã€‚==**
>
>åŸå› åœ¨äºâ€œå¯¹ç§°æ€§é—®é¢˜â€ï¼ˆSymmetry Problemï¼‰ï¼š
>
>1.  å¦‚æœæ‰€æœ‰æƒé‡éƒ½åˆå§‹åŒ–ä¸º 0ï¼Œé‚£ä¹ˆåœ¨æ­£å‘ä¼ æ’­æ—¶ï¼ŒåŒä¸€å±‚ä¸­çš„æ‰€æœ‰ç¥ç»å…ƒæ¥æ”¶åˆ°çš„è¾“å…¥ï¼ˆåœ¨ç»è¿‡å‰ä¸€å±‚åŠ æƒæ±‚å’Œåï¼‰å°†æ˜¯ç›¸åŒçš„ï¼ˆå› ä¸º Wâ‹…x å¯¹äºæ‰€æœ‰ç¥ç»å…ƒçš„è¾“å…¥ x æ¥è¯´ï¼Œå¦‚æœ W å…¨ä¸º 0ï¼Œç»“æœéƒ½æ˜¯ 0ï¼Œç„¶ååŠ ä¸Šåç½® bï¼‰ã€‚
>2.  è¿™æ„å‘³ç€åœ¨åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦æ—¶ï¼ŒåŒä¸€å±‚ä¸­çš„æ‰€æœ‰æƒé‡ä¼šå¾—åˆ°å®Œå…¨ç›¸åŒçš„æ¢¯åº¦ã€‚
>3.  å› æ­¤ï¼Œåœ¨å‚æ•°æ›´æ–°æ—¶ï¼ŒåŒä¸€å±‚ä¸­çš„æ‰€æœ‰æƒé‡ä¼šä»¥å®Œå…¨ç›¸åŒçš„æ–¹å¼è¿›è¡Œæ›´æ–°ã€‚
>4.  ç»“æœæ˜¯ï¼ŒåŒä¸€å±‚ä¸­çš„æ‰€æœ‰ç¥ç»å…ƒå°†å­¦ä¹ åˆ°å®Œå…¨ç›¸åŒçš„ç‰¹å¾ã€‚æ— è®ºä½ è®¾ç½®äº†å¤šå°‘ä¸ªç¥ç»å…ƒï¼Œå®ƒä»¬çš„åŠŸèƒ½éƒ½æ˜¯å†—ä½™çš„ï¼Œç½‘ç»œçš„èƒ½åŠ›å°†å¤§å¤§å—é™ï¼Œæ— æ³•å­¦ä¹ åˆ°å¤æ‚çš„æ¨¡å¼ã€‚ç½‘ç»œåŸºæœ¬ä¸Šå°±ç­‰åŒäºåªæœ‰ä¸€ä¸ªç¥ç»å…ƒçš„å±‚ã€‚
>
>**å…³äº FNN ä¸­ W æƒé‡çŸ©é˜µå¦‚ä½•åˆå§‹åŒ–çš„ï¼š**
>
>ç”±äºä¸èƒ½åˆå§‹åŒ–ä¸º 0ï¼Œæƒé‡é€šå¸¸éœ€è¦è¢«åˆå§‹åŒ–ä¸º**å°çš„éšæœºå€¼**ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ï¼š
>
>1.  **æ‰“ç ´å¯¹ç§°æ€§ï¼š** ç¡®ä¿ä¸åŒç¥ç»å…ƒåœ¨è®­ç»ƒå¼€å§‹æ—¶å…·æœ‰ä¸åŒçš„æƒé‡ï¼Œä»è€Œèƒ½å¤Ÿå­¦ä¹ åˆ°ä¸åŒçš„ç‰¹å¾ã€‚
>2.  **é¿å…æ¢¯åº¦æ¶ˆå¤±æˆ–çˆ†ç‚¸ï¼š** åˆé€‚çš„åˆå§‹åŒ–å¯ä»¥å¸®åŠ©æ§åˆ¶æ¿€æ´»å€¼å’Œæ¢¯åº¦çš„å°ºåº¦ï¼Œä½¿å…¶åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸ä¼šå˜å¾—è¿‡å°ï¼ˆå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ï¼‰æˆ–è¿‡å¤§ï¼ˆå¯¼è‡´æ¢¯åº¦çˆ†ç‚¸ï¼‰ã€‚
>
>ä¸€äº›å¸¸è§çš„æƒé‡åˆå§‹åŒ–æ–¹æ³•åŒ…æ‹¬ï¼š
>
>1.  **éšæœºå‡åŒ€åˆ†å¸ƒåˆå§‹åŒ– (Random Uniform Initialization):** å°†æƒé‡ä»ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒ [a,b] ä¸­éšæœºé‡‡æ ·ã€‚é€šå¸¸ a å’Œ b ä¼šæ ¹æ®è¾“å…¥å’Œè¾“å‡ºç¥ç»å…ƒçš„æ•°é‡è¿›è¡Œç¼©æ”¾ï¼Œä»¥æ§åˆ¶æ–¹å·®ã€‚
>2.  **éšæœºæ­£æ€åˆ†å¸ƒåˆå§‹åŒ– (Random Normal Initialization):** å°†æƒé‡ä»ä¸€ä¸ªå‡å€¼ä¸º 0ã€æ ‡å‡†å·®ä¸º Ïƒ çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºé‡‡æ ·ã€‚æ ‡å‡†å·® Ïƒ ä¹Ÿéœ€è¦æ ¹æ®å±‚çš„å¤§å°è¿›è¡Œè°ƒæ•´ã€‚
>3.  <img src="./assets/image-20250421085415517.png" alt="image-20250421085415517" style="zoom:50%;" />
>
>ç°ä»£æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆå¦‚ TensorFlow, PyTorchï¼‰é€šå¸¸æä¾›äº†è¿™äº›æ ‡å‡†çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨æ„å»ºç½‘ç»œå±‚æ—¶å¯ä»¥æ–¹ä¾¿åœ°æŒ‡å®šä½¿ç”¨å“ªç§åˆå§‹åŒ–å™¨ã€‚
>
>æ€»ä¹‹ï¼Œæƒé‡åˆå§‹åŒ–æ˜¯ FNN æˆåŠŸè®­ç»ƒçš„å…³é”®ä¸€æ­¥ã€‚åˆå§‹åŒ–ä¸º 0 ä¼šå¯¼è‡´ç½‘ç»œæ— æ³•å­¦ä¹ ï¼Œè€Œä½¿ç”¨å°çš„éšæœºå€¼ï¼ˆç‰¹åˆ«æ˜¯æ ¹æ®å±‚å¤§å°å’Œæ¿€æ´»å‡½æ•°è°ƒæ•´çš„ Xavier æˆ– He åˆå§‹åŒ–ï¼‰æ˜¯æ¨èçš„åšæ³•ã€‚

**ç»“æ„åŒ–é£é™©å‡½æ•°(å¸¦æœ‰æ­£åˆ™åŒ–é¡¹çš„æŸå¤±å‡½æ•°)**

>   $$
>   \mathbb{R}(W,b) = \frac{1}{N}\sum^{N}_{n=1}L(y^{(n)},\hat{y}^{(n)})+\frac{1}{2}\lambda||W||^2_F\\
>   \\
>   FrobeniusèŒƒæ•°:||W||^2_F = \sum^{L}_{l=1}\sum^{M_1}_{i=1}\sum^{M_{i-1}}_{j=1}(w^{(l)}_{ij})^2(æ¯ä¸ªç¥ç»å…ƒæƒé‡çš„å¹³æ–¹å’Œ)\\
>   \\
>   \mathbb{R}(W,b) = \frac{1}{N}\sum^{N}_{n=1}L(y^{(n)},\hat{y}^{(n)})+\frac{1}{2}\lambda(\sum^{L}_{l=1}\sum^{M_1}_{i=1}\sum^{M_{i-1}}_{j=1}(w^{(l)}_{ij})^2)
>   $$

**æ¢¯åº¦ä¸‹é™æ³•==(æŸ¥æ‰¾æŸå¤±å‡½æ•°çš„æœ€å°å€¼=æŸ¥æ‰¾æœ€ä¼˜çš„å‚æ•°çŸ©é˜µ)==**

>   $$
>   \begin{align}
>   W^{(l)}\leftarrow W^{(l)} - \alpha\frac{\partial\mathbb{R}(W,b)}{\partial W^{(l)}} &= W^{(l)}-\alpha(\frac{1}{N}\sum^{N}_{n=1}(\frac{\partial\mathbb{L}(y^{(n)},\hat{y}^{(n)})}{\partial W^{(l)}})+\lambda W^{(l)}) \\
>   \\
>   b^{(l)}\leftarrow b^{(l)} - \alpha\frac{\partial\mathbb{R}(W,b)}{\partial b^{(l)}} &= b^{(l)}-\alpha(\frac{1}{N}\sum^{N}_{n=1}(\frac{\partial\mathbb{L}(y^{(n)},\hat{y}^{(n)})}{\partial b^{(l)}})
>   \end{align}
>   $$

## **4.åå‘ä¼ æ’­(BPç®—æ³•)**

###### **1.å‰æ(å¼•å…¥é“¾å¼æ³•åˆ™)**

>   ä¸Šè¿°æ¢¯åº¦ä¸‹é™æ³•ä¼šå¾ˆç¹ç:å¯¹çŸ©é˜µè¿›è¡Œå¾®åˆ†,æ‰€ä»¥æˆ‘ä»¬å…ˆè®¡ç®—Losså¯¹äºæ¯ä¸ªå‚æ•°çš„åå¯¼
>   $$
>   \begin{align}\frac{\partial\mathbb{L}(y,\hat{y})}{\partial \omega^{(l)}_{ij}} = \frac{\partial\mathbb{L}(y,\hat{y})}{\partial z^{(l)}}
>   \frac{\partial z^{(l)}}{\partial \omega^{(l)}_{ij}}\\
>   
>   \frac{\partial\mathbb{L}(y,\hat{y})}{\partial b^{(l)}} = \frac{\partial\mathbb{L}(y,\hat{y})}{\partial z^{(l)}}
>   \frac{\partial z^{(l)}}{\partial b^{(l)}}
>   \end{align}
>   \Rightarrow
>   \frac{\partial z^{(l)}}{\partial \omega^{(l)}_{ij}},
>   \frac{\partial z^{(l)}}{\partial b^{(l)}},\frac{\partial\mathbb{L}(y,\hat{y})}{\partial z^{(l)}}
>   $$

**<font color=red>æ ¸å¿ƒå…¬å¼:$z^{(l)}=W^{(l)}a^{(l-1)}+b^{(l)}Â $</font>**

**2.è®¡ç®—$\frac{\partial z^{(l)}}{\partial \omega^{(l)}_{ij}}$ä¸”($z^{(l)}=W^{(l)}a^{(l-1)}+b^{(l)} $)**

>   
>   $$
>   \begin{align}
>   \frac{\partial z^{(l)}}{\partial \omega^{(l)}_{ij}} 
>   &= 
>   \bigg[
>   \frac{\partial z^{(l)}_1}{\partial \omega^{(l)}_{ij}},\cdots,
>   \frac{\partial z^{(l)}_i}{\partial \omega^{(l)}_{ij}},\cdots,
>   \frac{\partial z^{(l)}_{M_l}}{\partial \omega^{(l)}_{ij}}
>   \bigg]\\
>   &=
>   \bigg[
>   0,\cdots,
>   \frac{\partial (\omega_{i:}^{(l)}a^{(l-1))}+b^{l}_{i})}{\partial \omega^{(l)}_{ij}},\cdots,
>   0
>   \bigg]
>   \\
>   &=
>   \bigg[
>   0,\cdots,
>   a^{(l-1)}_j,\cdots,
>   0
>   \bigg]
>   \end{align}
>   $$
>   **($\omega_{i:}$ä¸ºæƒé‡çŸ©é˜µğ‘¾^{(ğ‘™)} çš„ç¬¬ğ‘– è¡Œ)**

**3.è®¡ç®—**$\frac{\partial z^{(l)}}{\partial b^{(l)}}$ä¸”($z^{(l)}=W^{(l)}a^{(l-1)}+b^{(l)} $)

>   **å¸¸æ•°é¡¹,æ±‚å¯¼äº†ä»¥åå°±æ˜¯å•ä½çŸ©é˜µ**

**4.è®¡ç®—**$\frac{\partial\mathbb{L}(y,\hat{y})}{\partial z^{(l)}}$

>**æ„ä¹‰:**
>
>>   **a.è¡¨ç¤ºç¬¬ğ‘™å±‚ç¥ç»å…ƒå¯¹æœ€ç»ˆæŸå¤±çš„å½±å“**
>>
>>   **b.æœ€ç»ˆæŸå¤±å¯¹ç¬¬ğ‘™å±‚ç¥ç»å…ƒçš„æ•æ„Ÿç¨‹åº¦**
>>
>>   **c.ä¸åŒç¥ç»å…ƒå¯¹ç½‘ç»œèƒ½åŠ›çš„è´¡çŒ®ç¨‹åº¦**
>
>**==å› æ­¤ç§°ä½œç¬¬lå±‚ç¥ç»å…ƒçš„è¯¯å·®é¡¹,ç”¨$\delta$è¡¨ç¤º==**
>$$
>\begin{align}\delta^{(l)} 
>= \frac{\partial\mathbb{L}(y,\hat{y})}{\partial z^{(l)}}
>= 
>\frac{\partial\mathbb{L}(y,\hat{y})}{\partial z^{(l+1)}}
>\frac{\partial z^{(l+1)}}{\partial a^{(l)}}
>\frac{\partial a^{(l)}}{\partial z^{(l)}}
>\end{align}
>\\\quad
>a^{(l)} = f_l(z^{(l)})(æ¿€æ´»åçš„è¾“å‡ºå€¼)
>$$
>**<font color=red>ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬ğ‘™å±‚çš„è¯¯å·®é¡¹å¯ä»¥é€šè¿‡ç¬¬ğ‘™+1å±‚çš„è¯¯å·®é¡¹è®¡ç®—</font>**

**5.é‡å†™å…¬å¼(åå‘æ±‚å¯¼çš„å½¢å¼)**

>$$
>\begin{align}
>\frac{\partial\mathbb{L}(y,\hat{y})}{\partial \omega^{(l)}_{ij}}
>&= 
>\big[
>0,\cdots,a^{(l-1)}_{j},\cdots,0
>[\delta^{(l)}_1,\cdots,\delta^{(l)}_i,\cdots,\delta^{(l)}_{Ml}] 
>\\
>&= \delta^{(l)}_i  a^{(l-1)}_{j}
>\\
>\\
>\big[\frac{\partial\mathbb{L}(y,\hat{y})}{\partial \omega^{(l)}_{ij}}\big]_{ij} &= [\delta^{(l)}_i  a^{(l-1)}_{j}]_{ij}(è¿›ä¸€æ­¥åŒ–ä¸ºçš„çŸ©é˜µå½¢å¼)
>\end{align}
>$$
>
>**å¯¹äºæ¯ä¸€å±‚è€Œè¨€**
>$$
>\begin{align}
>\frac{\partial\mathbb{L}(y,\hat{y})}{\partial \omega^{(l)}} &= \delta^{(l)}(a^{l-1})^T\\
>\\
>\frac{\partial\mathbb{L}(y,\hat{y})}{\partial b^{(l)}} &= \delta^{(l)}
>\end{align}
>$$

###### **2.åå‘ä¼ æ’­çš„è¯¦ç»†è¿‡ç¨‹**

**ä½¿ç”¨è¯¯å·®åå‘ä¼ æ’­ç®—æ³•çš„å‰é¦ˆç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥ï¼š**

>   ï¼ˆ1ï¼‰ å‰é¦ˆè®¡ç®—æ¯ä¸€å±‚çš„å‡€è¾“å…¥$ğ’›^{(ğ‘™)}$ å’Œæ¿€æ´»å€¼$ğ’‚^{(ğ‘™)}$ï¼Œç›´åˆ°æœ€åä¸€å±‚ï¼›
>
>   ï¼ˆ2ï¼‰ åå‘ä¼ æ’­è®¡ç®—æ¯ä¸€å±‚çš„è¯¯å·®é¡¹ğ›¿(ğ‘™)ï¼›
>   $$
>   \begin{align}\delta^{(l)} 
>   = \frac{\partial\mathbb{L}(y,\hat{y})}{\partial z^{(l)}}
>   &= 
>   \frac{\partial\mathbb{L}(y,\hat{y})}{\partial z^{(l+1)}}
>   \frac{\partial z^{(l+1)}}{\partial a^{(l)}}
>   \frac{\partial a^{(l)}}{\partial z^{(l)}}\\
>   \\
>   &=\delta^{(l+1)}W^{l+1} âŠ™f'(z^{(l)})(éšè—å±‚)\\
>   \\
>   \delta^{(L)} 
>   = \frac{\partial\mathbb{L}(y,\hat{y})}{\partial z^{(l)}}
>   &= 
>   \frac{\partial\mathbb{L}(y,\hat{y})}{\partial \hat{y}}
>   âŠ™
>   \frac{\partial \hat{y}}{\partial z^{(l)}}\\
>   \\
>   &=\frac{\partial\mathbb{L}}{\partial \hat{y}^{(L)}}âŠ™f'(z^{(L)})(æœ€åä¸€å±‚)
>   \end{align}
>   $$
>
>   >   **è§£é‡Š:**
>   >
>   >   $\delta^{(l+1)}$:  $l+1$å±‚çš„è¯¯å·®é¡¹
>   >
>   >   $W^{l+1}$:  $l$å±‚åˆ°$l+1$å±‚çš„æƒé‡çŸ©é˜µ
>   >
>   >   $f'(z^{(l)})$:  ç¬¬$l$å±‚æ¿€æ´»å‡½æ•°å¯¹å‡€è¾“å…¥çš„å¯¼æ•°
>   >
>   >   >|           | $f(x)$               | $f'(x)$  | $\frac{\partial a^{(l)}}{\partial z^{(l)}}$ |
>   >   >| --------- | -------------------- | -------- | ------------------------------------------- |
>   >   >| $Sigmoid$ | $\frac{1}{1+e^{-x}}$ | $a(1-a)$ | $a^{(l)}(1-a^{(l)})$                        |
>   >   >| $ReLU $   | $max(0,z)$           | -        | -                                           |
>   >   >| $Tanh$    | $tanh(z)$            | $1-a^2$  | $1-(a^{(l)})^2$                             |
>
>   >   **ä½¿ç”¨Hadamard Productçš„åŸå› :**
>   >
>   >   $\delta^{(l+1)}$æ˜¯$[N_{l+1},1]$,$W^{l+1}$æ˜¯$[N_{l},N_{l+1}]$,ä¹˜ç§¯æ˜¯$[N_{l},1]$çš„åˆ—å‘é‡
>   >
>   >   $f'(z^l)$æ˜¯é€å…ƒç´ æ±‚å¯¼çš„$[N_l,1]$çš„å‘é‡
>   >   $$
>   >   a = \begin{bmatrix}1&2&3\\4&5&6\\7&8&9\end{bmatrix},b = \begin{bmatrix}1&2&3\\4&5&6\\7&8&9\end{bmatrix}\Rightarrow aâŠ™b =Â \begin{bmatrix}1*1&2*2&3*3\\4*4&5*5&6*6\\7*7&8*8&9*9\end{bmatrix}
>   >   $$
>
>   ï¼ˆ3ï¼‰ è®¡ç®—æ¯ä¸€å±‚å‚æ•°çš„åå¯¼æ•°ï¼Œå¹¶æ›´æ–°å‚æ•°ï¼

## **5.è‡ªåŠ¨æ¢¯åº¦è®¡ç®—**

#### **1.æ•°å€¼å¾®åˆ†**

**æ•°å€¼å¾®åˆ†ï¼ˆNumerical Differentiationï¼‰æ˜¯ç”¨æ•°å€¼æ–¹æ³•æ¥è®¡ç®—å‡½æ•°ğ‘“(ğ‘¥)çš„å¯¼æ•°**
$$
\begin{align}
f'(x) &= lim_{\Delta x\rightarrow0}\frac{f(x+\Delta x)-f(x)}{\Delta x}\\
\\
f'(x) &= lim_{\Delta x\rightarrow0}\frac{f(x+\Delta x)-f(x-\Delta x)}{2\Delta x}
\end{align}
$$
**å‡è®¾æ¯æ¬¡æ­£å‘ä¼ æ’­çš„è®¡ç®—å¤æ‚åº¦ä¸º$ğ‘‚(ğ‘)$ï¼Œåˆ™è®¡ç®—æ•°å€¼å¾®åˆ†çš„æ€»ä½“æ—¶é—´å¤æ‚åº¦ä¸º$$ğ‘‚(ğ‘^2)$$ï¼**

#### **2.ç¬¦å·å¾®åˆ†**

**ç¬¦å·å¾®åˆ†ï¼ˆSymbolic Differentiationï¼‰æ˜¯ä¸€ç§åŸºäºç¬¦å·è®¡ç®—çš„è‡ªåŠ¨æ±‚å¯¼æ–¹æ³•ï¼**

ç¬¦å·è®¡ç®—çš„è¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯æ•°å­¦è¡¨è¾¾å¼ï¼Œä¸€èˆ¬åŒ…æ‹¬å¯¹æ•°å­¦è¡¨è¾¾å¼çš„åŒ–ç®€ã€å› å¼åˆ†è§£ã€å¾®

åˆ†ã€ç§¯åˆ†ã€è§£ä»£æ•°æ–¹ç¨‹ã€æ±‚è§£å¸¸å¾®åˆ†æ–¹ç¨‹ç­‰è¿ç®—ï¼

ç¬¦å·è®¡ç®—çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ç¬¦å·è®¡ç®—å’Œå¹³å°æ— å…³ï¼Œå¯ä»¥åœ¨CPU æˆ–GPU ä¸Šè¿è¡Œ

ç¬¦å·å¾®åˆ†ä¹Ÿæœ‰ä¸€äº›ä¸è¶³ä¹‹å¤„ï¼š

>   1ï¼‰ç¼–è¯‘æ—¶é—´è¾ƒé•¿ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¾ªç¯ï¼Œéœ€è¦å¾ˆé•¿æ—¶é—´è¿›è¡Œç¼–è¯‘ï¼›
>
>   2ï¼‰ä¸ºäº†è¿›è¡Œç¬¦å·å¾®åˆ†ï¼Œä¸€èˆ¬éœ€è¦è®¾è®¡ä¸€ç§ä¸“é—¨çš„è¯­è¨€æ¥è¡¨ç¤ºæ•°å­¦è¡¨è¾¾å¼ï¼Œå¹¶ä¸”è¦å¯¹å˜é‡ï¼ˆç¬¦å·ï¼‰è¿›è¡Œé¢„å…ˆå£°æ˜
>
>   3ï¼‰å¾ˆéš¾å¯¹ç¨‹åºè¿›è¡Œè°ƒè¯•

#### **3.è‡ªåŠ¨å¾®åˆ†**

###### **1.è‡ªåŠ¨å¾®åˆ†ç®€ä»‹**

è‡ªåŠ¨å¾®åˆ†çš„åŸºæœ¬åŸç†æ˜¯æ‰€æœ‰çš„æ•°å€¼è®¡ç®—å¯ä»¥**åˆ†è§£ä¸ºä¸€äº›åŸºæœ¬æ“ä½œ**ï¼ŒåŒ…å« +, âˆ’, Ã—, / å’Œä¸€äº›åˆç­‰å‡½æ•°exp, log, sin, cos ç­‰ï¼Œç„¶ååˆ©ç”¨**é“¾å¼æ³•åˆ™**æ¥è®¡ç®—ä¸€ä¸ªå¤åˆå‡½æ•°çš„æ¢¯åº¦

![image-20250420183421001](./assets/image-20250420183421001.png)

###### **2.å‰å‘æ¨¡å¼**

$$
\begin{align}
&\frac{\partial h_1}{\partial \omega}
\\
\frac{\partial h_2}{\partial \omega}=&\frac{\partial h_2}{\partial h_1}\frac{\partial h_1}{\partial \omega}
\\
\frac{\partial h_3}{\partial \omega}=&\frac{\partial h_3}{\partial h_2}\frac{\partial h_2}{\partial h_1}\frac{\partial h_1}{\partial 
\omega}
\\
\frac{\partial f(x;\omega,b)}{\partial \omega}=&\frac{\partial h_n}{\partial h_{n-1}}\cdots\frac{\partial h_2}{\partial h_1}\frac{\partial h_1}{\partial 
\omega}
\end{align}
$$

###### **3.åå‘æ¨¡å¼(é€’å½’)**

$$
\begin{align}
\frac{\partial f(x;\omega,b)}{\partial h_n}&=???\\
\\
\frac{\partial f(x;\omega,b)}{\partial h_{n-1}} &= \frac{\partial f(x;\omega,b)}{\partial h_{n}}\frac{\partial h_{n}}{\partial h_{n-1}}
\\
\vdots\qquad&=\qquad\vdots\\
\\
\frac{\partial f(x;\omega,b)}{\partial w} &= \frac{\partial f(x;\omega,b)}{\partial h_{1}}\frac{\partial h_{1}}{\partial w}

\end{align}
$$

###### **4.é™æ€è®¡ç®—å›¾å’ŒåŠ¨æ€è®¡ç®—å›¾**

é™æ€è®¡ç®—å›¾æ˜¯åœ¨ç¼–è¯‘æ—¶æ„å»ºè®¡ç®—å›¾ï¼Œè®¡ç®—å›¾æ„å»ºå¥½ä¹‹ååœ¨ç¨‹åºè¿è¡Œæ—¶ä¸èƒ½æ”¹å˜.

åŠ¨æ€è®¡ç®—å›¾æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€æ„å»ºï¼

é™æ€è®¡ç®—å›¾åœ¨æ„å»ºæ—¶å¯ä»¥è¿›è¡Œä¼˜åŒ–ï¼Œå¹¶è¡Œèƒ½åŠ›å¼ºï¼Œä½†çµæ´»æ€§æ¯”è¾ƒå·®ï¼

åŠ¨æ€è®¡ç®—å›¾åˆ™ä¸å®¹æ˜“ä¼˜åŒ–ï¼Œå½“ä¸åŒè¾“å…¥çš„ç½‘ç»œç»“æ„ä¸ä¸€è‡´æ—¶ï¼Œéš¾ä»¥å¹¶è¡Œè®¡ç®—ï¼Œä½†çµæ´»æ€§é«˜

###### **5.ç¬¦å·å¾®åˆ†ä¸è‡ªåŠ¨å¾®åˆ†çš„å¯¹æ¯”**

<img src="./assets/image-20250420184809063.png" alt="image-20250420184809063" style="zoom:80%;" />

## **6.ä¼˜åŒ–é—®é¢˜**

#### **1.éå‡¸ä¼˜åŒ–é—®é¢˜**

**å¹³æ–¹è¯¯å·®æŸå¤±$(1-y)^2$å’Œäº¤å‰ç†µæŸå¤±å‡½æ•°$logy$çš„é€‰æ‹©**

![image-20250420184916242](./assets/image-20250420184916242.png)

#### **2.æ¢¯åº¦æ¶ˆå¤±é—®é¢˜**

![image-20250420185302618](./assets/image-20250420185302618.png)

**å¦‚æœxè½´è¶‹è¿‘äº0,yå°±è¶‹è¿‘äº1,æ¯æ¬¡è¿­ä»£çš„å‰©ä½™é‡å¾ˆå°,ç›´åˆ°æ¶ˆå¤±**

![image-20250420185410158](./assets/image-20250420185410158.png)